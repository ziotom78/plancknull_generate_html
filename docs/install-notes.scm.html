<!doctype html>
<html>
<head>
<title>install-notes.scm</title>
<link rel="stylesheet" href="schematic.css" /></head>
<body>
<div id="background"></div>
<div id="container">
<table cellspacing="0" cellpadding="0">
<tr>
<th class="docs">
<h1>install-notes.scm</h1></th>
<th class="code"></th></tr>
<tr id="section-1">
<td class="docs">
<div class="pilwrap"><a class="pilcrow" href="#section-1">&para;</a></div><h1>How to generate the executable</h1>

<p>The program is written in Scheme
<a href="http://www.schemers.org/Documents/Standards/R5RS/">R5RS</a>, and it
needs to be compiled into an executable in order to be executed.
There are two ways to do it: either grab a precompiled binary (easy
way) or compile it by yourself (hard way). In the following section
we'll detail the two procedures.</p>

<h2>Grabbing the executable (easy way)</h2>

<p>You can ask Maurizio Tomasi for a self-contained bundle. At the LFI
DPC and at NERSC, he keeps one in his homedir. The bundle is a
directory containing the executable (named <code>standalone_generator</code>)
and a large set of dynamic libraries needed to run the program. You
can move this directory anywhere in your filesystem, but do not try
to run it on different architectures/distributions (e.g. from a
RedHat system to Ubuntu, from x86 to x86_64...).</p>

<h2>Compiling the executable from the source (hard way)</h2>

<p>To compile the source code into an executable you must have the
<a href="http://www.call-cc.org/">Chicken Scheme</a> compiler and a few
open-source libraries for Chicken (called
<a href="http://wiki.call-cc.org/eggs"><em>eggs</em></a>). To install Chicken, you
can use your package manager (e.g. <code>sudo apt-get install
chicken-bin</code> under Ubuntu Linux) if you are a <code>sudo</code> user.
Otherwise, you must install it from source in your home directory.
Open a terminal and run the following commands (if you do not see
the second line fully, select the text with the mouse):</p>

<pre><code>mkdir -p $HOME/usr $HOME/.chicken-temp
curl http://code.call-cc.org/releases/current/chicken.tar.gz | tar xz -C $HOME/.chicken-temp
pushd $HOME/.chicken-temp/chicken-*
make PLATFORM=linux PREFIX=$HOME/usr install
popd
rm -rf $HOME/.chicken-temp
</code></pre>

<p>(If you want, you can change <code>$HOME/usr</code> with any other directory
you want. It should be the place where you usually install things
under your home directory.) At this point, if you did not so
already, put the following lines at the end of your <code>~/.profile</code>
(assuming you're using <code>sh</code>, <code>bash</code> or <code>dash</code> as your login shell):</p>

<pre><code>export PATH=$HOME/usr/bin:$PATH
export C_INCLUDE_PATH=$HOME/usr/include:$C_INCLUDE_PATH
export LIBRARY_PATH=$HOME/usr/lib:$LIBRARY_PATH
export LD_LIBRARY_PATH=$HOME/usr/lib:$LD_LIBRARY_PATH
export MANPATH=$HOME/usr/man:$MANPATH
</code></pre>

<p>Logout and login to see the new variabiles. If you are able to run
<code>chicken -version</code>, then the installation of the compiler
completed successfully.</p>

<p>Now you need some "eggs" (that is, Chicken's libraries). Move to
the directory where you have the source code of
<code>plancknull_generate_html</code> and run the following command:</p>

<pre><code>sudo make install_eggs
</code></pre>

<p>(If you've installed Chicken under your homedir, omit <code>sudo</code>). Now
you should be able to compile the program, simply run</p>

<pre><code>make generator
</code></pre>

<p>This will silently convert <code>generator.scm</code> into a C program, which
will then be compiled to a standalone executable. The <code>Makefile</code>
provided with the source code allows for many targets, run <code>make
TARGET</code> where <code>TARGET</code> is one of the following:</p>

<ul>
<li><code>generator</code> produces the executable. Be careful that this program
needs the Chicken runtime libraries to be accessible at runtime
(therefore you cannot distribute it)</li>
<li><code>deploy</code> produces a stand-alone executable in the directory
<code>standalone_generator</code>. Unlike the <code>generator</code> target, the content
of the directory (containing the executable <code>standalone_generator</code>
plus many dynamic libraries) <em>can</em> be distributed to others, as all
the Chicken libraries needed by the program are included in the
directory. (You can think of it as Chicken's analogous to Mac OS X
<code>.app</code> directories.)</li>
<li><code>install_eggs</code> repeatedly calls <code>chicken-install</code> to install the
eggs required to compile the program. You might have to use <code>sudo</code>
(e.g. this is the case if you installed Chicken using Ubuntu's
<code>apt-get</code>).</li>
<li><code>documentation</code> runs Schematic on the source code to produce this
documentation (in the <code>docs</code> directory).</li>
<li><code>help</code> prints a summary of the available options implemented in
the makefile.</li>
</ul>

<h1>How to run the program</h1>

<p>To run the program, you must have
<a href="http://healpix.jpl.nasa.gov/html/facilitiesnode9.htm"><code>map2tga</code></a>
and <code>convert</code> (part of
<a href="http://www.imagemagick.org/script/index.php">ImageMagick</a> &mdash;
its fork <a href="http://www.graphicsmagick.org/">GraphicsMagick</a> should be
ok as well) in your path. <code>map2tga</code> is provided by
<a href="http://healpix.jpl.nasa.gov/">Healpix</a>: if you work with
Planck/LFI, you surely have it. (Note that it is already installed
at the LFI DPC.)</p>

<p>The program needs as input one or more JSON files containing
information about the products of the null tests. Typically, these
are produced by the
<a href="https://github.com/zonca/plancknull"><code>plancknull</code></a> program. You
can specify them from the command line:</p>

<pre><code>$ generator NULL_TEST_DIRECTORY OUTPUT_PATH
</code></pre>

<p>(If you are using the standalone executable, run
<code>standalone_generator</code> instead of <code>generator</code>). This will read the
results of the null tests from the subdirectories under
<code>NULL_TEST_DIRECTORY</code>, and it will create the directory
<code>OUTPUT_PATH</code> and populate it with the files needed for the HTML
report. If <code>OUTPUT_PATH</code> does not exist, it will be silently
created.</p>

<h1>How to read the source code of this program</h1>

<p>This page was created automatically from the program source code
using <a href="http://wiki.call-cc.org/eggref/4/schematic"><code>schematic</code></a>, a
documenting tool for Chicken Scheme. Install it from the command
line with the command <code>sudo chicken-install schematic</code>, then
run</p>

<pre><code>schematic -f markdown generator.scm
</code></pre>

<p>(assuming you have
<a href="http://en.wikipedia.org/wiki/Markdown"><code>markdown</code></a>, which can be
easily installed using <code>apt-get</code> under Debian/Ubuntu). This will
create a sub-directory <code>html</code> where you'll find the source code of
this very webpage.</p>
</td>
<td class="code">
<pre class="highlight"></pre></td></tr></table></div></body></html>